# é¡¹ç›®æ–‡ä»¶è¯´æ˜

## ğŸ“ æ–‡ä»¶ç»“æ„

```
MCP_DOCUMENTATION/
â”œâ”€â”€ claude_agent.py              # â­ Claude è‡ªä¸»ä»£ç†ï¼ˆæ ¸å¿ƒæ–‡ä»¶ï¼‰
â”œâ”€â”€ mcp_sdk.py                   # MCP å®¢æˆ·ç«¯ SDK
â”œâ”€â”€ test_mcp_tools.py            # MCP æœåŠ¡æµ‹è¯•è„šæœ¬
â”œâ”€â”€ quick_test.py                # å¿«é€Ÿæµ‹è¯•è„šæœ¬
â”œâ”€â”€ README_CLAUDE_AGENT.md       # è¯¦ç»†ä½¿ç”¨æ–‡æ¡£
â”œâ”€â”€ .env.example                 # API Key é…ç½®ç¤ºä¾‹
â”œâ”€â”€ academic_agent.py            # æ—§ç‰ˆç¡¬ç¼–ç ä»£ç†ï¼ˆå·²è¢« claude_agent.py æ›¿ä»£ï¼‰
â””â”€â”€ main_test.py                 # æ—§ç‰ˆæµ‹è¯•è„šæœ¬ï¼ˆå·²è¢« test_mcp_tools.py æ›¿ä»£ï¼‰
```

## ğŸ¯ æ ¸å¿ƒæ”¹è¿›ï¼šä»ç¡¬ç¼–ç åˆ°è‡ªä¸»å†³ç­–

### âŒ æ—§æ–¹å¼ï¼ˆacademic_agent.pyï¼‰

```python
# ç¡¬ç¼–ç æµç¨‹
task1 = self.client_deep.call_tool("DeepResearch", {...})
task2 = self.client_arxiv.call_tool("searchArxivByAbstract", {...})
results = await asyncio.gather(task1, task2)
```

**é—®é¢˜ï¼š**
- æµç¨‹å›ºå®šï¼Œæ— æ³•æ ¹æ®æ•°æ®åŠ¨æ€è°ƒæ•´
- éœ€è¦æ‰‹åŠ¨ç¼–å†™æ¯ä¸ªæ­¥éª¤
- æ— æ³•æ™ºèƒ½é€‰æ‹©æœ€ä½³å·¥å…·ç»„åˆ

### âœ… æ–°æ–¹å¼ï¼ˆclaude_agent.pyï¼‰

```python
# ç»™ Claude ä¸€ä¸ªé«˜å±‚æŒ‡ä»¤
instruction = """
è¯·ç»¼åˆåˆ©ç”¨ 6000-6007 ç«¯å£çš„æ‰€æœ‰å­¦æœ¯æœç´¢å·¥å…·ï¼Œ
ä¸ºæˆ‘ç”Ÿæˆä¸€ä»½å…³äº Large Language Models çš„ä¸¥è°¨ç»¼è¿°æŠ¥å‘Šã€‚
"""

# Claude è‡ªä¸»å†³å®šè°ƒç”¨å“ªäº›å·¥å…·ã€ä»¥ä»€ä¹ˆé¡ºåº
result = await agent.run(instruction, max_iterations=15)
```

**ä¼˜åŠ¿ï¼š**
- âœ… Claude è‡ªä¸»å†³ç­–è°ƒç”¨å“ªäº›å·¥å…·
- âœ… è§‚å¯Ÿæ•°æ®ååŠ¨æ€è°ƒæ•´ç­–ç•¥
- âœ… æ™ºèƒ½èåˆå¤šä¸ªæ•°æ®æº
- âœ… é—­ç¯æ‰§è¡Œï¼Œæ— éœ€äººå·¥å¹²é¢„

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ­¥éª¤ 1: é…ç½® API Key

åˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
ANTHROPIC_API_KEY=sk-ant-api03-ä½ çš„å®Œæ•´APIå¯†é’¥
```

æˆ–è®¾ç½®ç¯å¢ƒå˜é‡ï¼š

```powershell
# PowerShell
$env:ANTHROPIC_API_KEY="sk-ant-api03-ä½ çš„å®Œæ•´APIå¯†é’¥"
```

### æ­¥éª¤ 2: æµ‹è¯• MCP æœåŠ¡ï¼ˆå¯é€‰ï¼‰

```bash
# æµ‹è¯•æ‰€æœ‰æœåŠ¡
python test_mcp_tools.py

# å¿«é€Ÿæµ‹è¯•å•ä¸ªæœåŠ¡
python quick_test.py
```

### æ­¥éª¤ 3: è¿è¡Œ Claude è‡ªä¸»ä»£ç†

```bash
python claude_agent.py
```

## ğŸ“‹ å·¥ä½œåŸç†

### 1. å·¥å…·æ˜ å°„ï¼ˆclaude_agent.py:48-168ï¼‰

å°† MCP æœåŠ¡æ³¨å†Œä¸º Claude å·¥å…·ï¼š

```python
def get_tool_definitions(self):
    return [
        {
            "name": "deep_research",
            "description": "ä½¿ç”¨é›†æ€è°±çš„æ·±åº¦ç ”ç©¶å¼•æ“...",
            "input_schema": {
                "type": "object",
                "properties": {
                    "searchQuery": {"type": "string"},
                    "count": {"type": "integer"}
                }
            }
        },
        # ... å…¶ä»– 7 ä¸ªå·¥å…·
    ]
```

### 2. å·¥å…·æ‰§è¡Œï¼ˆclaude_agent.py:170-237ï¼‰

æ¡¥æ¥ Claude çš„å·¥å…·è°ƒç”¨å’Œå®é™…çš„ MCP è°ƒç”¨ï¼š

```python
async def execute_tool(self, tool_name: str, tool_input: Dict):
    if tool_name == "deep_research":
        result = await self.mcp_clients["deep_research"].call_tool(
            "DeepResearch",
            {"searchQuery": tool_input["searchQuery"], ...}
        )
    # ... å¤„ç†å…¶ä»–å·¥å…·
    return json.dumps(result)
```

### 3. è‡ªä¸»å†³ç­–å¾ªç¯ï¼ˆclaude_agent.py:239-345ï¼‰

```python
while iteration < max_iterations:
    # 1. Claude åˆ†æå½“å‰çŠ¶æ€
    response = self.client.messages.create(
        model="claude-3-5-sonnet-20241022",
        tools=self.get_tool_definitions(),
        messages=self.conversation_history
    )

    # 2. å¦‚æœ Claude å†³å®šè°ƒç”¨å·¥å…·
    if response.stop_reason == "tool_use":
        for block in response.content:
            if block.type == "tool_use":
                # æ‰§è¡Œå·¥å…·
                result = await self.execute_tool(block.name, block.input)
                # å°†ç»“æœè¿”å›ç»™ Claude
                self.conversation_history.append({"role": "user", "content": result})

    # 3. å¦‚æœ Claude å®Œæˆä»»åŠ¡
    elif response.stop_reason == "end_turn":
        return final_result
```

## ğŸ”„ æ‰§è¡Œæµç¨‹ç¤ºä¾‹

```
ç”¨æˆ·: "è¯·ç”Ÿæˆå…³äº LLM çš„ç»¼è¿°æŠ¥å‘Š"
    â†“
Claude: "æˆ‘éœ€è¦å…ˆæœç´¢ç›¸å…³è®ºæ–‡"
    â†“ å†³å®šè°ƒç”¨ deep_research
æ‰§è¡Œ: deep_research(searchQuery="Large Language Models", count=10)
    â†“ è¿”å› 10 ç¯‡è®ºæ–‡
Claude: "æˆ‘çœ‹åˆ°æœ‰å‡ ç¯‡ arXiv è®ºæ–‡ï¼Œè®©æˆ‘è·å–è¯¦ç»†ä¿¡æ¯"
    â†“ å†³å®šè°ƒç”¨ arxiv_search_by_id
æ‰§è¡Œ: arxiv_search_by_id(key="1706.03762")
    â†“ è¿”å›è¯¦ç»†ä¿¡æ¯
Claude: "æˆ‘è¿˜éœ€è¦æŸ¥æ‰¾ç”Ÿç‰©åŒ»å­¦é¢†åŸŸçš„åº”ç”¨"
    â†“ å†³å®šè°ƒç”¨ entrez_search
æ‰§è¡Œ: entrez_search(db="pubmed", term="large language model")
    â†“ è¿”å›ç›¸å…³æ–‡çŒ®
Claude: "æ•°æ®å·²æ”¶é›†å®Œæ¯•ï¼Œå¼€å§‹ç”ŸæˆæŠ¥å‘Š"
    â†“ ç”Ÿæˆ Markdown æ ¼å¼æŠ¥å‘Š
è¾“å‡º: LLM_Survey_by_Claude.md
```

## ğŸ¨ è‡ªå®šä¹‰ä»»åŠ¡

ä¿®æ”¹ `claude_agent.py` çš„ `main()` å‡½æ•°ï¼š

```python
instruction = """
è¯·å¸®æˆ‘è°ƒç ” Transformer æ¶æ„çš„æ¼”è¿›å†å²ã€‚

è¦æ±‚ï¼š
1. æ‰¾å‡º 5-10 ç¯‡å…³é”®è®ºæ–‡
2. æŒ‰æ—¶é—´é¡ºåºæ’åˆ—
3. è¯´æ˜æ¯ç¯‡è®ºæ–‡çš„æ ¸å¿ƒåˆ›æ–°ç‚¹
4. é‡ç‚¹å…³æ³¨ Attention æœºåˆ¶çš„æ”¹è¿›
"""

result = await agent.run(instruction, max_iterations=15)
```

## ğŸ› ï¸ å¯ç”¨å·¥å…·åˆ—è¡¨

| å·¥å…·åç§° | ç«¯å£ | åŠŸèƒ½ | é€‚ç”¨åœºæ™¯ |
|---------|------|------|---------|
| `crossref_search` | 6000 | æœç´¢å­¦æœ¯æ–‡çŒ®å…ƒæ•°æ® | æŸ¥æ‰¾å·²å‘è¡¨è®ºæ–‡çš„ DOIã€å¼•ç”¨ |
| `bioc_get_article` | 6001 | è·å– PMC æ–‡çŒ®è¯¦æƒ… | ç”Ÿç‰©åŒ»å­¦å…¨æ–‡è·å– |
| `deep_research` | 6002 | é›†æ€è°±ç»¼åˆæœç´¢ | æœ€å¼ºå¤§çš„ç»¼åˆæœç´¢ |
| `arxiv_search_by_abstract` | 6003 | é€šè¿‡æ‘˜è¦æœç´¢ arXiv | AI/ML é¢†åŸŸæœ€æ–°ç ”ç©¶ |
| `openlibrary_search` | 6004 | æœç´¢å›¾ä¹¦ | æŸ¥æ‰¾å­¦æœ¯ä¹¦ç±å’Œæ•™æ |
| `entrez_search` | 6005 | æœç´¢ NCBI æ•°æ®åº“ | ç”Ÿç‰©åŒ»å­¦å’Œç”Ÿå‘½ç§‘å­¦ |
| `arxiv_search_by_id` | 6006 | é€šè¿‡ ID æŸ¥æ‰¾ arXiv | ç²¾ç¡®æŸ¥æ‰¾å·²çŸ¥è®ºæ–‡ |
| `arxiv_search_by_title` | 6007 | é€šè¿‡æ ‡é¢˜æœç´¢ arXiv | æ¨¡ç³Šæ ‡é¢˜æœç´¢ |

## ğŸ’¡ æœ€ä½³å®è·µ

1. **æ˜ç¡®ä»»åŠ¡ç›®æ ‡**: ç»™ Claude æ¸…æ™°çš„æŒ‡ä»¤å’Œå…·ä½“è¦æ±‚
2. **åˆç†è®¾ç½®è¿­ä»£æ¬¡æ•°**: ç®€å•ä»»åŠ¡ 5-10 æ¬¡ï¼Œå¤æ‚ä»»åŠ¡ 15-20 æ¬¡
3. **ç›‘æ§æ‰§è¡Œè¿‡ç¨‹**: è§‚å¯Ÿ Claude çš„å·¥å…·é€‰æ‹©ï¼Œä¼˜åŒ–æŒ‡ä»¤
4. **é€‰æ‹©åˆé€‚å·¥å…·**: ä¸åŒé¢†åŸŸä½¿ç”¨ä¸åŒå·¥å…·ç»„åˆ
5. **éªŒè¯ç»“æœ**: æ£€æŸ¥ç”Ÿæˆçš„æŠ¥å‘Šï¼Œå¿…è¦æ—¶æ‰‹åŠ¨è¡¥å……

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

| æŒ‡æ ‡ | æ—§æ–¹å¼ (academic_agent.py) | æ–°æ–¹å¼ (claude_agent.py) |
|------|---------------------------|--------------------------|
| çµæ´»æ€§ | âŒ å›ºå®šæµç¨‹ | âœ… åŠ¨æ€è°ƒæ•´ |
| æ™ºèƒ½æ€§ | âŒ æ— å†³ç­–èƒ½åŠ› | âœ… è‡ªä¸»å†³ç­– |
| å¯æ‰©å±•æ€§ | âš ï¸ éœ€ä¿®æ”¹ä»£ç  | âœ… åªéœ€æ·»åŠ å·¥å…·å®šä¹‰ |
| æ•°æ®èåˆ | âš ï¸ æ‰‹åŠ¨ç¼–å†™ | âœ… è‡ªåŠ¨æ•´åˆ |
| é”™è¯¯å¤„ç† | âŒ éœ€æ‰‹åŠ¨å¤„ç† | âœ… Claude è‡ªåŠ¨é‡è¯• |

## ğŸ” è°ƒè¯•æŠ€å·§

### æŸ¥çœ‹ Claude çš„å†³ç­–è¿‡ç¨‹

ç¨‹åºä¼šè¾“å‡ºè¯¦ç»†æ—¥å¿—ï¼š

```
ğŸ”„ [è¿­ä»£ 1/15]
   ğŸ¯ Claude å†³å®šè°ƒç”¨: deep_research
ğŸ”§ [å·¥å…·æ‰§è¡Œ] deep_research
   å‚æ•°: {"searchQuery": "Large Language Models", "count": 10}
   âœ… æˆåŠŸè·å–æ•°æ®

ğŸ”„ [è¿­ä»£ 2/15]
   ğŸ¯ Claude å†³å®šè°ƒç”¨: arxiv_search_by_id
...
```

### æµ‹è¯•å•ä¸ªå·¥å…·

```bash
python quick_test.py
```

### å®Œæ•´æœåŠ¡æµ‹è¯•

```bash
python test_mcp_tools.py
```

## âš ï¸ å¸¸è§é—®é¢˜

### 1. è®¤è¯å¤±è´¥ (401)

- æ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„ API Key æ˜¯å¦å®Œæ•´
- ç¡®è®¤è´¦æˆ·ä½™é¢å……è¶³
- è®¿é—® https://console.anthropic.com é‡æ–°ç”Ÿæˆ Key

### 2. å·¥å…·è°ƒç”¨å¤±è´¥

- ç¡®è®¤ MCP æœåŠ¡ï¼ˆ6000-6007 ç«¯å£ï¼‰æ­£åœ¨è¿è¡Œ
- è¿è¡Œ `python test_mcp_tools.py` æ£€æŸ¥æœåŠ¡çŠ¶æ€

### 3. è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°

- å¢åŠ  `max_iterations` å‚æ•°
- ç®€åŒ–ä»»åŠ¡æŒ‡ä»¤
- æ£€æŸ¥æ˜¯å¦æœ‰å·¥å…·æŒç»­è¿”å›ç©ºç»“æœ

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **è¯¦ç»†ä½¿ç”¨æŒ‡å—**: `README_CLAUDE_AGENT.md`
- **API Key é…ç½®**: `.env.example`
- **MCP SDK æ–‡æ¡£**: `mcp_sdk.py` æ³¨é‡Š

## ğŸ“ å­¦ä¹ èµ„æº

- Anthropic API æ–‡æ¡£: https://docs.anthropic.com
- Claude Tool Use æŒ‡å—: https://docs.anthropic.com/claude/docs/tool-use
- MCP åè®®: https://modelcontextprotocol.io

---

**æ€»ç»“**: é€šè¿‡å°† MCP æœåŠ¡æ³¨å†Œä¸º Claude å·¥å…·ï¼Œå®ç°äº†ä»ç¡¬ç¼–ç æµç¨‹åˆ°è‡ªä¸»å†³ç­–çš„å‡çº§ï¼Œè®© AI çœŸæ­£æˆä¸ºä½ çš„ç ”ç©¶åŠ©æ‰‹ï¼
